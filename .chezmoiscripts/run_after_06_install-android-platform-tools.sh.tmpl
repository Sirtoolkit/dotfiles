#!{{ lookPath "bash" }}

# Script para instalar Android Platform Tools solo si no est√°n instalados
# Se ejecuta una sola vez con chezmoi
{{ if eq .chezmoi.os "darwin" -}}

set -e  # Salir si hay error

echo "üîç Verificando instalaci√≥n de Android Platform Tools..."

# Verificar si ADB ya est√° instalado y funcionando
if command -v adb &> /dev/null; then
    echo "‚úÖ ADB ya est√° instalado: $(adb version 2>/dev/null | head -n1 || echo 'versi√≥n no disponible')"
    exit 0
fi

echo "üì¶ ADB no encontrado. Procediendo con la instalaci√≥n..."

echo "‚¨áÔ∏è  Descargando Android Platform Tools..."

# Aceptar licencias autom√°ticamente e instalar platform-tools
yes | sdkmanager --licenses > /dev/null 2>&1 || true
sdkmanager "platform-tools"

# Verificar que la instalaci√≥n fue exitosa
if [ -f "$ANDROID_HOME/platform-tools/adb" ]; then
    echo "‚úÖ Android Platform Tools instaladas correctamente"
else
    echo "‚ùå Error: No se pudo instalar Android Platform Tools"
    exit 1
fi
{{ end -}}
