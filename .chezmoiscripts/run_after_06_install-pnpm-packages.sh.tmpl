#!/bin/bash
set -e

if ! command -v pnpm >/dev/null 2>&1; then
  echo "pnpm no está instalado. Por favor instala pnpm primero (debería estar en mise)."
  exit 1
fi

# Configurar PNPM_HOME si no existe
if [ -z "$PNPM_HOME" ]; then
  export PNPM_HOME="$HOME/Library/pnpm"
fi

# Asegurar que PNPM_HOME está en el PATH
if [[ ":$PATH:" != *":$PNPM_HOME:"* ]]; then
  export PATH="$PNPM_HOME:$PATH"
fi

# Crear directorio si no existe
mkdir -p "$PNPM_HOME"

if command -v nx >/dev/null 2>&1; then
  echo "nx ya está instalado globalmente. Saltando instalación."
else
  echo "Instalando nx globalmente con pnpm..."
  pnpm add -g nx
fi

if command -v oco >/dev/null 2>&1; then
  echo "OpenCommit ya está instalado globalmente. Saltando instalación."
else
  echo "Instalando OpenCommit globalmente con pnpm..."
  pnpm add -g opencommit
fi

if command -v expo >/dev/null 2>&1; then
  echo "Expo ya está instalado globalmente. Saltando instalación."
else
  echo "Instalando Expo globalmente con pnpm..."
  pnpm add -g expo
fi
